<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <title>Categorical Feature Engineering | What is H2O?</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.0.3">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    
    <link rel="next" href="../hands-on_training/tools.html" />
    
    
    <link rel="prev" href="../hands-on_training/multi-model_parameter_tuning_for_higgs_dataset.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">

    
    <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-exercises/exercises.css">
    


        
    <div class="book"  data-level="3.5.2" data-basepath=".." data-revision="1416253371525">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="h2o_world_training_sandbox/README.html">
            
                
                    <a href="../h2o_world_training_sandbox/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         H2O World Training Sandbox
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="h2o_in_big_data_environments/README.html">
            
                
                    <a href="../h2o_in_big_data_environments/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         H2O in Big Data environments
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3" data-path="hands-on_training/README.html">
            
                
                    <a href="../hands-on_training/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         Hands-On Training
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.1" data-path="hands-on_training/h2o_with_the_web_ui.html">
            
                
                    <a href="../hands-on_training/h2o_with_the_web_ui.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                         H2O with the Web UI
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.2" data-path="hands-on_training/r_with_h2o.html">
            
                
                    <a href="../hands-on_training/r_with_h2o.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                         R with H2O 
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3" data-path="hands-on_training/supervised_learning_with_regressions.html">
            
                
                    <a href="../hands-on_training/supervised_learning_with_regressions.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                         Supervised Learning
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.3.1" data-path="hands-on_training/regression">
            
                
                    <a href="../hands-on_training/regression">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.1.</b>
                        
                         Regression
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.2" data-path="hands-on_training/classifications.html">
            
                
                    <a href="../hands-on_training/classifications.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.2.</b>
                        
                         Classifications
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.3.3" data-path="hands-on_training/deep_learning.html">
            
                
                    <a href="../hands-on_training/deep_learning.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.3.</b>
                        
                         Deep Learning
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3.4" data-path="hands-on_training/unsupervised_learning.html">
            
                
                    <a href="../hands-on_training/unsupervised_learning.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                         Unsupervised Learning
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.4.1" data-path="hands-on_training/kmeans_clustering.html">
            
                
                    <a href="../hands-on_training/kmeans_clustering.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.1.</b>
                        
                         KMeans Clustering
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.4.2" data-path="hands-on_training/dimensionality_reduction.html">
            
                
                    <a href="../hands-on_training/dimensionality_reduction.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.2.</b>
                        
                         Dimensionality Reduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.4.3" data-path="hands-on_training/anomoly_detection.html">
            
                
                    <a href="../hands-on_training/anomoly_detection.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.3.</b>
                        
                         Anomoly Detection
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3.5" data-path="hands-on_training/advanced_topics.html">
            
                
                    <a href="../hands-on_training/advanced_topics.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                         Advanced Topics
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="3.5.1" data-path="hands-on_training/multi-model_parameter_tuning_for_higgs_dataset.html">
            
                
                    <a href="../hands-on_training/multi-model_parameter_tuning_for_higgs_dataset.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.1.</b>
                        
                         Multi-model Parameter Tuning
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter active" data-level="3.5.2" data-path="hands-on_training/categorical_feature_engineering.html">
            
                
                    <a href="../hands-on_training/categorical_feature_engineering.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.2.</b>
                        
                         Categorical Feature Engineering
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3.5.3" data-path="hands-on_training/tools.html">
            
                
                    <a href="../hands-on_training/tools.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.3.</b>
                        
                         Tools
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3.6" data-path="hands-on_training/practical_use_cases">
            
                
                    <a href="../hands-on_training/practical_use_cases">
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                         Practical Use Cases
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="4" data-path="demos/README.html">
            
                
                    <a href="../demos/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                         Demos
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="4.1" data-path="demos/integration_with_tableau_and_excel.html">
            
                
                    <a href="../demos/integration_with_tableau_and_excel.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                         Tableau
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.2" data-path="demos/excel.html">
            
                
                    <a href="../demos/excel.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                         Excel
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4.3" data-path="demos/streaming_data.html">
            
                
                    <a href="../demos/streaming_data.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                         Streaming Data
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="5" data-path="hackers_station/README.html">
            
                
                    <a href="../hackers_station/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                         Hackers Station
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="5.1" data-path="hackers_station/start_developing_with_h2o.html">
            
                
                    <a href="../hackers_station/start_developing_with_h2o.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                         Start Developing with H2O
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.2" data-path="hackers_station/build_applications_on_top_of_h2o">
            
                
                    <a href="../hackers_station/build_applications_on_top_of_h2o">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                         Build Applications on Top of H2O
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5.3" data-path="hackers_station/start_with_sparkling_water">
            
                
                    <a href="../hackers_station/start_with_sparkling_water">
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                         Start with Sparkling Water
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="6" data-path="troubleshooting/README">
            
                
                    <a href="../troubleshooting/README">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                         Troubleshooting
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7" data-path="more_information/README.html">
            
                
                    <a href="../more_information/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                         More Information
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Google</button>
                <button type="button" data-sharing="facebook" class="button">Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Instapaper</button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >What is H2O?</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_1286">
                    
                        <h1 id="categorical-feature-engineering">Categorical Feature Engineering</h1>
<h3 id="feature-engineering-on-the-adult-dataset">Feature Engineering on the Adult dataset</h3>
<h6 id="this-tutorial-shows-feature-engineering-on-the-adult-datasethttpsarchiveicsuciedumldatasetsadult-this-file-is-both-valid-r-and-markdown-code">This tutorial shows feature engineering on the <a href="https://archive.ics.uci.edu/ml/datasets/Adult" target="_blank">Adult dataset</a>. This file is both valid R and markdown code.</h6>
<h3 id="start-h2o-and-load-the-adult-data">Start H2O and load the Adult data</h3>
<h6 id="initialize-the-h2o-server-and-import-the-adult-dataset">Initialize the H2O server and import the Adult dataset.</h6>
<pre><code>library(h2o)
h2oServer &lt;- h2o.init(nthreads=-1)
homedir &lt;- &quot;/data/h2o-training/adult/&quot;
TRAIN = &quot;adult.gz&quot;
data_hex &lt;- h2o.importFile(h2oServer, path = paste0(homedir,TRAIN), header = F, sep = &#39; &#39;, key = &#39;data_hex&#39;)
</code></pre><h6 id="we-manually-assign-column-names-since-they-are-missing-in-the-original-file">We manually assign column names since they are missing in the original file.</h6>
<pre><code>colnames(data_hex) &lt;- c(&quot;age&quot;,&quot;workclass&quot;,&quot;fnlwgt&quot;,&quot;education&quot;,&quot;education-num&quot;,&quot;marital-status&quot;,&quot;occupation&quot;,&quot;relationship&quot;,&quot;race&quot;,&quot;sex&quot;,&quot;capital-gain&quot;,&quot;capital-loss&quot;,&quot;hours-per-week&quot;,&quot;native-country&quot;,&quot;income&quot;)
summary(data_hex)
</code></pre><h6 id="we-will-try-to-predict-whether-income-is-50k-or-50k">We will try to predict whether <code>income</code> is <code>&lt;=50K</code> or <code>&gt;50K</code>.</h6>
<pre><code>summary(data_hex$income)
response = &quot;income&quot;
</code></pre><h6 id="first-we-source-a-few-helper-functionsbinaryclassificationhelperrhtml-that-allow-us-to-quickly-compare-a-multitude-of-binomial-classification-models-in-particular-the-h2ofit-and-h2oleaderboard-functions--note-that-these-specific-functions-require-variable-importances-and-n-fold-cross-validation-to-be-enabled">First, we source a few <a href="../binaryClassificationHelper.R.html">helper functions</a> that allow us to quickly compare a multitude of binomial classification models, in particular the h2o.fit() and h2o.leaderBoard() functions.  Note that these specific functions require variable importances and N-fold cross-validation to be enabled.</h6>
<pre><code>source(&quot;~/h2o-training/tutorials/advanced/binaryClassificationHelper.R.md&quot;)
</code></pre><h6 id="we-then-add-this-simple-helper-function-to-split-a-frame-into-trainvalidtest-pieces-train-a-glm-and-a-gbm-model-with-2-fold-cross-validation-and-obtaining-the-best-model-after-printing-a-leaderbaord-for-more-accurate">We then add this simple helper function to split a frame into train/valid/test pieces, train a GLM and a GBM model with 2-fold cross-validation and obtaining the best model after printing a leaderbaord. For more accurate</h6>
<pre><code>N_FOLDS = 2

h2o.trainModels &lt;- function(frame) {
  # split the data into train/valid/test
  random &lt;- h2o.runif(frame, seed = 123456789)
  train_hex &lt;- h2o.assign(frame[random &lt; .8,], &quot;train_hex&quot;)
  valid_hex &lt;- h2o.assign(frame[random &gt;= .8 &amp; random &lt; .9,], &quot;valid_hex&quot;)
  test_hex  &lt;- h2o.assign(frame[random &gt;= .9,], &quot;test_hex&quot;)

  predictors &lt;- colnames(frame)[-match(response,colnames(frame))]

  # multi-model comparison with N-fold cross-validation
  data = list(x=predictors, y=response, train=train_hex, valid=valid_hex, nfolds=N_FOLDS)
  models &lt;- c(
    h2o.fit(h2o.glm, data, glmparams),
    h2o.fit(h2o.gbm, data, gbmparams)
  )
  best_model &lt;- h2o.leaderBoard(models, test_hex, match(response,colnames(frame)))

  h2o.rm(h2oServer, grep(pattern = &quot;Last.value&quot;, x = h2o.ls(h2oServer)$Key, value = TRUE))
  best_model
}
</code></pre><h3 id="baseline-performance-on-original-dataset">Baseline performance on original dataset</h3>
<h6 id="for-simplicity-we-use-default-parameters-no-grid-search-parameter-tuning-to-establish-baseline-performance-numbers-for-this-dataset">For simplicity, we use default parameters (no grid search parameter tuning) to establish baseline performance numbers for this dataset.</h6>
<pre><code>glmparams &lt;- list(family=&quot;binomial&quot;, variable_importances=T, use_all_factor_levels=T)
gbmparams &lt;- list(importance=TRUE)

best_model &lt;- h2o.trainModels(data_hex)
</code></pre><h6 id="both-glm-and-gbm-do-a-great-job-at-this-dataset-we-get-validation-auc-values-of-above-90-glm-09028564-gbm-09009924">Both GLM and GBM do a great job at this dataset, we get validation AUC values of above 90%: <code>GLM: 0.9028564 GBM: 0.9009924</code></h6>
<h6 id="according-to-gbm-the-most-important-columns-are-marital-statusrelationshipcapital-gaineducation-numage">According to GBM, the most important columns are <code>marital-status,relationship,capital-gain,education-num,age</code></h6>
<h3 id="feature-engineering">Feature engineering</h3>
<h6 id="the-following-section-shows-ways-to-create-new-derived-features-well-need-this-simple-append-function-as-were-going-to-add-new-columns-the-our-dataset">The following section shows ways to create new derived features. We&#39;ll need this simple append function, as we&#39;re going to add new columns the our dataset</h6>
<pre><code>h2o.append &lt;- function(frame, col) {
  appended_frame &lt;- h2o.assign(cbind(frame, col), &quot;appended_frame&quot;)
  appended_frame
}
</code></pre><h4 id="1-turn-age-into-a-factor">1. Turn age into a factor</h4>
<h6 id="the-feature-age-is-an-integer-value-but-glm-for-example-will-have-a-tough-time-predicing-income-from-age-with-a-linear-relationship-while-gbm-should-be-able-to-carve-out-these-non-linear-dependencies-by-itself-but-it-might-need-more-trees-deeper-interaction-depth-than-default-values">The feature <code>age</code> is an integer value, but GLM for example will have a tough time predicing income from age with a linear relationship, while GBM should be able to carve out these non-linear dependencies by itself (but it might need more trees, deeper interaction depth than default values)</h6>
<pre><code>data_hex &lt;- h2o.append(data_hex, as.factor(data_hex$age))
colnames(data_hex)
summary(data_hex)
best_model &lt;- h2o.trainModels(data_hex)
</code></pre><h6 id="glm-clearly-benefited-from-this-we-see-that-ages-1819-and-20-are-among-the-most-important-predictors-for-income-and-we-get-the-following-validation-auc-values-glm-09066634-gbm-09009924">GLM clearly benefited from this. We see that ages 18,19 and 20 are among the most important predictors for income and we get the following validation AUC values: <code>GLM: 0.9066634 GBM: 0.9009924</code></h6>
<h6 id="for-fun-lets-look-at-the-largest-positively-and-negatively-correlated-coefficients">For fun, let&#39;s look at the largest positively and negatively correlated coefficients:</h6>
<pre><code>head(sort(best_model@model$normalized_coefficients,decreasing=T),5)
head(sort(best_model@model$normalized_coefficients,decreasing=F),5)
</code></pre><h4 id="2-same-for-capital-gainloss-and-work-hours-per-week">2. Same for capital-gain/loss and work hours per week</h4>
<pre><code>data_hex &lt;- h2o.append(data_hex, as.factor(data_hex$&#39;hours-per-week&#39;))
data_hex &lt;- h2o.append(data_hex, as.factor(data_hex$&#39;capital-gain&#39;))
data_hex &lt;- h2o.append(data_hex, as.factor(data_hex$&#39;capital-loss&#39;))
colnames(data_hex)
summary(data_hex)
best_model &lt;- h2o.trainModels(data_hex)
</code></pre><h6 id="with-all-these-new-factor-levels-as-predictors-glm-now-got-a-nice-boost-glm-09285384-gbm-09021225">With all these new factor levels as predictors, GLM now got a nice boost: <code>GLM: 0.9285384 GBM: 0.9021225</code></h6>
<h6 id="lets-give-gbm-a-shot-at-beating-glm-by-using-better-parameters">Let&#39;s give GBM a shot at beating GLM by using better parameters:</h6>
<pre><code>gbmparams &lt;- list(importance=TRUE, n.tree=50, interaction.depth=10)
best_model &lt;- h2o.trainModels(data_hex)
</code></pre><h6 id="ok-now-both-algorithms-reach-similar-validation-auc-values-glm-09285384-gbm-09286973">Ok, now both algorithms reach similar validation AUC values: <code>GLM: 0.9285384 GBM: 0.9286973</code></h6>
<h3 id="replace-money-related-integer-columns-by-their-log-transform">Replace money-related integer columns by their Log-Transform</h3>
<pre><code>data_hex$&#39;capital-gain&#39;   &lt;- log(1+data_hex$&#39;capital-gain&#39;)
data_hex$&#39;capital-loss&#39;   &lt;- log(1+data_hex$&#39;capital-loss&#39;)
data_hex
best_model &lt;- h2o.trainModels(data_hex)
</code></pre><h6 id="we-see-that-the-training-auc-for-glm-improves-slightly-from-09269056070-to-09269586507-intuition-money-is-often-distributed-exponentially-and-the-log-transform-brings-it-back-to-a-linear-space-note-that-the-validation-auc-drops-likely-due-to-small-data-statistical-noise-we-clearly-got-close-to-the-limit-of-this-dataset-note-that-gbm-didnt-benefit-from-this-transform-it-seems-to-be-able-to-better-split-up-the-original-integer-space">We see that the training AUC for GLM improves slightly, from <code>0.9269056070</code> to <code>0.9269586507</code>. Intuition: Money is often distributed exponentially, and the log transform brings it back to a linear space. Note that the validation AUC drops, likely due to small data statistical noise. We clearly got close to the limit of this dataset. Note that GBM didn&#39;t benefit from this transform, it seems to be able to better split up the original integer space.</h6>
<pre><code>frame &lt;- data_hex
random &lt;- h2o.runif(frame, seed = 123456789)
train_hex &lt;- h2o.assign(frame[random &lt; .8,], &quot;train_hex&quot;)
valid_hex &lt;- h2o.assign(frame[random &gt;= .8 &amp; random &lt; .9,], &quot;valid_hex&quot;)
test_hex  &lt;- h2o.assign(frame[random &gt;= .9,], &quot;test_hex&quot;)

predictors &lt;- colnames(frame)[-match(response,colnames(frame))]

# multi-model comparison with N-fold cross-validation
data = list(x=predictors, y=response, train=train_hex, valid=valid_hex, nfolds=N_FOLDS)
models &lt;- c(
  h2o.fit(h2o.deeplearning, data, list())
)
best_model &lt;- h2o.leaderBoard(models, test_hex, match(response,colnames(frame)))
</code></pre>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../hands-on_training/multi-model_parameter_tuning_for_higgs_dataset.html" class="navigation navigation-prev " aria-label="Previous page: Multi-model Parameter Tuning"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../hands-on_training/tools.html" class="navigation navigation-next " aria-label="Next page: Tools"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-exercises/ace/ace.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-exercises/ace/theme-tomorrow.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-exercises/ace/mode-javascript.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-exercises/exercises.js"></script>
    

    
    <script src="https://cdn.mathjax.org/mathjax/2.4-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        <script src="../gitbook/plugins/gitbook-plugin-exercises/jsrepl/jsrepl.js" id="jsrepl-script"></script>
    </body>
    
</html>
